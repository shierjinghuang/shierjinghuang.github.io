<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="IGP高级特性, 十二惊惶">
    <meta name="description" content="IGP高级特性包括多种快速收敛和保护机制，用于降低网络故障导致的流量丢失，以及路由选路及路由信息的控制，能够减少特定路由器路由表的大小">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>IGP高级特性 | 十二惊惶</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="十二惊惶" type="application/atom+xml">
<link href="https://cdn.bootcss.com/KaTeX/0.11.1/katex.min.css" rel="stylesheet" /></head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/1.jpg" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">十二惊惶</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/1.jpg" class="logo-img circle responsive-img">
        
        <div class="logo-name">十二惊惶</div>
        <div class="logo-desc">
            
            犁牛之子骍且角，虽欲勿用，山川其舍诸
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://gitee.com/Im-so-scared-2/shier_jinghuang" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>十二惊惶
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://gitee.com/Im-so-scared-2/shier_jinghuang" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="十二惊惶" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    
<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/1.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">IGP高级特性</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B/">
                                <span class="chip bg-color">网络工程</span>
                            </a>
                        
                            <a href="/tags/IGP/">
                                <span class="chip bg-color">IGP</span>
                            </a>
                        
                            <a href="/tags/%E8%B7%AF%E7%94%B1%E4%B8%8E%E4%BA%A4%E6%8D%A2%E8%BF%9B%E9%98%B6/">
                                <span class="chip bg-color">路由与交换进阶</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E7%9B%B8%E5%85%B3/" class="post-category">
                                网络工程相关
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2024-01-01
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2025-05-05
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    10.3k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    38 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>[TOC]</p>
<h1>IGP高级特性</h1>
<h2 id="ospf高级特性">OSPF高级特性</h2>
<blockquote>
<p><strong><font color="FF6600">OSPF和IS-IS的高级特性，包括：快速收敛机制、路由控制</font></strong></p>
</blockquote>
<ul>
<li>OSPF和IS-IS都是基于链路状态的内部网关路由协议，运行这两种协议的路由器通过同步LSDB，采用SPF算法计算最优路由</li>
</ul>
<h3 id="ospf快速收敛">OSPF快速收敛</h3>
<p>OSPF快速收敛是为了提高路由的收敛速度而做的扩展特性，包括：<strong>PRC:[Partial Route Calculation]</strong>——部分路由计算和智能定时器</p>
<p>同时，OSPF支持故障恢复快速收敛，例如通过**OSPF IP FRR[Fast reroute，快速重路由]**实现备份链路的快速切换，也可以与BFD联动实现对故障的快速感知</p>
<h4 id="prc-部分路由计算：">PRC 部分路由计算：</h4>
<blockquote>
<p>PRC的工作原理：当网络上路由发生变化的时候，只对发生变化的路由进行重新计算</p>
</blockquote>
<ul>
<li>在主流的华为和思科设备上，OSPF的PRC功能是默认开启的</li>
</ul>
<img src="./IGP高级特性/PRC新增直连路由.png" style="zoom:67%;" />
<h4 id="智能定时器">智能定时器:</h4>
<img src="./IGP高级特性/智能定时器.png"  />
<h5 id="发送端配置：">发送端配置：</h5>
<blockquote>
<p><strong><font color="blue">格式：[Huawei-ospf] lsa-originate-interval { 0 | { intelligent-timer max-interval start-interval hold-interval | other-type interval } }</font></strong></p>
</blockquote>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment">#	0：指定LSA更新的时间间隔为0，即取消LSA的5秒的更新时间间隔。</span>
<span class="token comment">#	intelligent-timer：指定通过智能定时器设置OSPF Router LSA和Network LSA的更新间隔时间</span>
<span class="token comment">#	max-interval：指定更新OSPF LSA的最长间隔时间。整数形式，取值范围是1～120000，单位是毫秒。缺省值是5000</span>
<span class="token comment">#	start-interval：指定更新OSPF LSA的初始间隔时间。整数形式，取值范围是0～60000，单位是毫秒。缺省值是500</span>
<span class="token comment">#	hold-interval：指定更新OSPF LSA的基数间隔时间。整数形式，取值范围是1～60000，单位是毫秒。缺省值是1000</span>
<span class="token comment">#	other-type：指定设置除OSPF Router LSA和Network LSA外LSA的更新间隔时间</span>
<span class="token comment">#	interval：指定LSA更新的时间间隔。整数形式，取值范围是0～10，单位是秒。缺省值是5</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>缺省情况下，使能智能定时器intelligent-timer，更新LSA的最长间隔时间max-interval为5000毫秒、初始间隔时间start-interval为500毫秒、基数间隔时间hold-interval为1000<strong>毫秒</strong></p>
</blockquote>
<ol>
<li>初次更新LSA的间隔时间由<code>start-interval</code>参数指定</li>
<li>第n次更新LSA的间隔时间为<code>hold-interval×2^[n-2]</code></li>
<li>当<code>hold-interval×2[n-2]</code>达到指定的最长间隔时间<code>max-interval</code>时，OSPF连续三次更新LSA的时间间隔都是最长间隔时间，之后，再次返回步骤1，按照初始间隔时间<code>start-interval</code>更新LSA</li>
</ol>
<blockquote>
<ul>
<li>触发路由计算的时间间隔较长，同样会影响网络的收敛速度</li>
<li>智能定时器首次超时时间是一个固定的时间。如果在定时器超时前，又有触发定时器的事件发生，则该定时器下一次的超时时间会增加</li>
</ul>
</blockquote>
<p><strong>接收端配置：</strong></p>
<blockquote>
<p><strong><font color="blue">命令：[Huawei-ospf-1] lsa-arrival-interval { interval | intelligent-timer max-interval start-interval hold-interval }</font></strong></p>
</blockquote>
<ul>
<li>interval：指定LSA接收的时间间隔。取值范围是0～10000，单位是毫秒</li>
<li>intelligent-timer：指定通过智能定时器设置LSA接收的间隔时间</li>
<li>max-interval：指定接收OSPF LSA的最长间隔时间，取值范围是1～120000，单位是毫秒。缺省值是1000</li>
<li>start-interval：指定接收OSPF LSA的初始间隔时间，取值范围是0～60000，单位是毫秒。缺省值是500</li>
<li>hold-interval：指定接收OSPF LSA的基数间隔时间，取值范围是1～60000，单位是毫秒。缺省值是500</li>
</ul>
<blockquote>
<p>缺省情况下，使能智能定时器<code>intelligent-timer</code>，SPF计算的最长间隔时间<code>max-interval</code>为10000毫秒、初始间隔时间<code>start-interval</code>为500毫秒、基数间隔时间<code>hold-interval</code>为1000毫秒</p>
</blockquote>
<p>设置OSPF路由计算时间间隔:**</p>
<blockquote>
<p><strong><font color="blue">命令：[Huawei-ospf-1] spf-schedule-interval { interval1 | intelligent-timer max-interval start-interval hold-interval | millisecond interval2 }</font></strong></p>
</blockquote>
<p>缺省情况下，使能智能定时器<strong>intelligent-timer</strong>，SPF计算的最长间隔时间max-interval为10000毫秒、初始间隔时间start-interval为500毫秒、基数间隔时间hold-interval为1000毫秒</p>
<blockquote>
<p>使用智能定时器后，SPF计算的时间间隔如下：</p>
</blockquote>
<ul>
<li>初次计算SPF的间隔时间由<strong>start-interval参数指定</strong></li>
<li>第n（n≥2）次计算SPF的间隔时间为hold-interval×2^(n-2)</li>
<li>当hold-interval×2^(n-2)达到指定的最长间隔时间max-interval时，OSPF连续三次计算SPF的时间间隔都是最长间隔时间，之后，再次返回步骤1，<strong>按照初始间隔时间start-interval计算SPF</strong></li>
</ul>
<pre class="line-numbers language-huawei" data-language="huawei"><code class="language-huawei">#	interval1：指定OSPF SPF计算间隔时间。整数形式，取值范围是1～10，单位是秒
#	intelligent-timer：指定通过智能定时器设置OSPF SPF计算的间隔时间
#	max-interval：指定OSPF SPF计算的最长间隔时间，取值范围是1～120000毫秒。缺省值是10000
#	start-interval：指定OSPF SPF计算的初始间隔时间，取值范围是1～60000毫秒。缺省值是500
#	hold-interval：指定OSPF SPF计算的基数间隔时间，取值范围是1～60000毫秒。缺省值是1000
#	millisecond interval2：指定OSPF SPF计算间隔时间，取值范围是1～10000毫秒<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h4 id="ospf-ip-frr：">OSPF IP FRR：</h4>
<blockquote>
<p><strong><font color="FF6600">OSPF IP FRR（Fast reroute，快速重路由）是动态IP FRR，利用LFA（Loop-Free Alternates）算法预先计算出备份路径，保存在转发表中，以备在故障时将流量快速切换到备份链路上，保证流量不中断，从而达到流量保护的目的，该功能可将故障恢复时间降低到50ms以内</font></strong></p>
</blockquote>
<p><strong>LFA计算备份链路的基本思路</strong>是：</p>
<ul>
<li>以可提供备份链路的邻居为根节点，利用SPF算法计算出到目的节点的最短距离。然后，按照不等式计算出开销最小且无环的备份链路</li>
</ul>
<blockquote>
<p><font color="blue">OSPF IP FRR的流量保护分为链路保护和节点链路双保护</font></p>
<ul>
<li>当需要保护的对象是经过特定链路的流量时，流量保护类型为链路保护</li>
<li>当需要保护的对象是经过特定设备的流量时，流量保护类型为节点链路双保护。节点保护优先级高于链路保护</li>
</ul>
</blockquote>
<img src="./IGP高级特性/OSPF_IP_FRR流量保护.png" style="zoom:80%;" />
<h5 id="ospf-ip-frr的基础配置命令">OSPF IP FRR的基础配置命令</h5>
<p>使能OSPF IP FRR</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>Huawei-ospf-1<span class="token punctuation">]</span> frr
<span class="token punctuation">[</span>Huawei-ospf-1-frr<span class="token punctuation">]</span>
<span class="token comment">#	创建并进入OSPF FRR视图。</span>
<span class="token punctuation">[</span>Huawei-ospf-1-frr<span class="token punctuation">]</span> loop-free-alternate
<span class="token comment">#	使能OSPF IP FRR功能，利用LFA算法计算备份下一跳和备份出接口。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>阻止OSPF接口的FRR能力</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/1<span class="token punctuation">]</span> ospf frr block
<span class="token comment">#	对于承载重要业务的节点设备，通过该命令在指定接口上禁止OSPF IP FRR功能，从而使此接口相连的对端设备不成为备份链路上的节点设备，避免使能OSPF IP FRR功能后对节点设备上运行的重要业务造成影响。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h4 id="ospf与bfd联动">OSPF与BFD联动:</h4>
<blockquote>
<p>OSPF与BFD联动就是将BFD和OSPF关联起来，一旦与邻居之间的链路出现故障，BFD对链路故障的快速感应能够加快OSPF对于网络拓扑变化的响应</p>
</blockquote>
<ul>
<li>配置指定进程或指定接口的OSPF与BFD联动功能，可以快速检测链路的状态，故障检测时间可以达到毫秒级，提高链路状态变化时OSPF的收敛速度</li>
</ul>
<img src="./IGP高级特性/OSPF与BFD联动工作原理.png" style="zoom:80%;" />
<h5 id="ospf与bfd联动的基础配置命令">OSPF与BFD联动的基础配置命令</h5>
<p><strong>1、配置OSPF的BFD特性</strong></p>
<blockquote>
<blockquote>
<p><font color="blue">如果需要使用BFD功能快速检测链路故障，则必须在系统视图下执行bfd命令，使能全局BFD功能</font></p>
</blockquote>
</blockquote>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>Huawei-ospf-1<span class="token punctuation">]</span> bfd all-interfaces <span class="token builtin class-name">enable</span>
<span class="token comment">#	在OSPF进程下使能BFD特性</span>
<span class="token punctuation">[</span>Huawei-ospf-1<span class="token punctuation">]</span> bfd all-interfaces <span class="token punctuation">&#123;</span>min-rx-interval receive-interval <span class="token operator">|</span> min-tx-interval transmit-interval <span class="token operator">|</span> detect-multiplier multiplier-value <span class="token operator">|</span> frr-binding <span class="token punctuation">&#125;</span> 
<span class="token comment">#	配置BFD会话的参数值</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>min-rx-interval receive-interval：指定期望从对端接收BFD报文的最小接收间隔，取值范围是10～2000毫秒。缺省值是1000毫秒</li>
<li>min-tx-interval transmit-interval：指定向对端发送BFD报文的最小发送间隔，取值范围是10～2000毫秒。缺省值是1000毫秒</li>
<li>detect-multiplier multiplier-value：指定本地检测倍数，取值范围是3～50，缺省值是3</li>
<li>frr-binding：将BFD会话状态与接口的链路状态进行绑定。当BFD会话状态变为Down时，接口的物理层链路状态也会变为Down，从而触发流量切换到备份路径</li>
</ul>
<p><strong>2、配置指定接口的BFD特性</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/1<span class="token punctuation">]</span> ospf bfd <span class="token builtin class-name">enable</span>
<span class="token comment">#	在使能OSPF的特定接口下使能BFD特性</span>
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/1<span class="token punctuation">]</span> ospf bfd <span class="token punctuation">&#123;</span> min-rx-interval receive-interval <span class="token operator">|</span> min-tx-interval transmit-interval <span class="token operator">|</span> detect-multiplier multiplier-value <span class="token operator">|</span> frr-binding <span class="token punctuation">&#125;</span>
<span class="token comment">#	在使能OSPF的特定接口下配置BFD会话的参数值</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>可以配置OSPF IP FRR与BFD联动：</p>
<ul>
<li>配置OSPF IP FRR特性时，需要底层能够快速响应链路变化，以便迅速将流量切换到备份链路</li>
<li>将OSPF IP FRR与BFD会话绑定可以达到快速感知故障的目的，确保故障后流量切换的及时性</li>
</ul>
<h3 id="ospf路由控制">OSPF路由控制</h3>
<h4 id="等价路由">等价路由:</h4>
<blockquote>
<p><font color="FF6600">路由表中存在到达同一目的地址，且同一路由协议发现的多条路由时，若这几条路由的开销值也相同，那么这些路由就是等价路由，可以实现<strong>负载分担</strong></font></p>
</blockquote>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment">#	设置进行负载分担的等价路由的最大数量：</span>
<span class="token punctuation">[</span>Huawei-ospf-1<span class="token punctuation">]</span> maximum load-balancing number<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h4 id="缺省路由">缺省路由:</h4>
<blockquote>
<p>区域边界和自治系统边界通常都是由多个路由器组成的多出口冗余备份或者负载分担。配置缺省路由，可以减少路由表的容量，保证网络的高可用性</p>
</blockquote>
<p>OSPF缺省路由通常应用于下面两种情况：</p>
<ul>
<li><strong><font color="blue">区域边界路由器[ABR]</font></strong>  发布<strong>Type3 LSA</strong>，指导区域内路由器进行区域之间报文的转发</li>
<li><strong><font color="blue">自治系统边界路由器[ASBR]</font></strong>  发布<strong>Type5 LSA</strong>或<strong>Type7 LSA</strong>，指导OSPF路由域内路由器进行域外报文的转发</li>
</ul>
<img src="./IGP高级特性/表格1.png" style="zoom:80%;" />
<blockquote>
<p><font color="blue">缺省路由是指目的地址和掩码都是0的路由。当设备无精确匹配的路由时，就可以通过缺省路由进行报文转发。由于OSPF路由的分级管理，Type3缺省路由的优先级高于Type5或Type7路由</font></p>
</blockquote>
<ul>
<li>
<p>普通区域：</p>
<ul>
<li>缺省情况下，普通OSPF区域内的OSPF路由器是不会产生缺省路由。当该路由器需要向OSPF发布缺省路由时，必须手工执行default-route-advertise命令，配置完成后，路由器会产生一个缺省ASE LSA[Type5 LSA]，并且通告到整个OSPF自治系统中。</li>
</ul>
</li>
<li>
<p>Stub区域：</p>
<ul>
<li>Stub区域不允许自治系统外部的路由[Type5 LSA]在区域内传播，区域内的路由器必须通过ABR学到自治系统外部的路由</li>
<li>Stub区域的ABR会自动产生一条缺省的Type3 LSA通告到整个Stub区域。ABR通过该缺省路由，将到达AS外部的流量吸引到自己这里，然后通过ABR转发出去。</li>
</ul>
</li>
<li>
<p>Totally Stub区域：</p>
<ul>
<li>Totally Stub区域既不允许自治系统外部的路由[Type5 LSA]在区域内传播，也不允许区域间路由[Type3 LSA]在区域内传播。区域内的路由器必须通过ABR学到自治系统外部和其他区域的路由</li>
<li>Totally Stub区域的ABR会自动产生一条缺省的Type3 LSA通告到整个Stub区域。ABR通过该缺省路由，将到达AS外部和其它区域的流量吸引到自己这里，然后通过ABR转发出去。</li>
</ul>
</li>
<li>
<p>NSSA区域：</p>
<ul>
<li>如果希望到达自治系统外部的路由通过本区域[NSSA区域]的ASBR到达，而其它外部路由通过其它区域出去。此时，ABR会产生一条Type7 LSA的缺省路由，通告到整个NSSA区域内。这样，除了某少部分路由通过NSSA的ASBR到达，其它路由都可以通过NSSA的ABR到达其它区域的ASBR出去。这种情况下，在ABR上无论路由表中是否存在缺省路由0.0.0.0，都会产生Type7 LSA的缺省路由</li>
<li>如果希望所有的外部路由只通过本区域[NSSA区域]的ASBR到达，则必须在ASBR上手动执行nssa [default-route-advertise]命令进行配置，使ASBR产生一条缺省的NSSA LSA[Type7 LSA]，通告到整个NSSA区域内。这样，所有的外部路由就只能通过本区域NSSA的ASBR到达。这种情况下，在ASBR上只有当路由表中存在缺省路由0.0.0.0时，才会产生Type7 LSA的缺省路由</li>
<li>注意：因为缺省路由只是在本NSSA区域内泛洪，并没有泛洪到整个OSPF域中，所以本NSSA区域内的路由器在找不到路由之后可以从该NSSA的ASBR出去，但不能实现其他OSPF域的路由从这个出口出去。Type7 LSA缺省路由不会在ABR上转换成Type5 LSA缺省路由泛洪到整个OSPF域。</li>
</ul>
</li>
<li>
<p>Totally NSSA区域：</p>
<ul>
<li>Totally NSSA的ABR会自动向该区域下发使用Type3 LSA描述的缺省路由，而Totally NSSA的ASBR则不会自动下发缺省路由。因此，在该场景下，对于区域内的路由器而言，可以通过ASBR引入的外部路由到达相应的外部网段、通过ABR下发的缺省路由到达其他网段</li>
<li>如果希望Totally NSSA内的路由器选择ASBR作为默认出口，而不是ABR，那么需要让ASBR也下发缺省路由，此时必须在ASBR上手工执行配置</li>
</ul>
</li>
</ul>
<h5 id="将缺省路由通告到ospf路由区域">将缺省路由通告到OSPF路由区域</h5>
<p><strong>1、将缺省路由通告到普通OSPF区域：</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>Huawei-ospf-1<span class="token punctuation">]</span> default-route-advertise <span class="token punctuation">[</span> <span class="token punctuation">[</span> always <span class="token operator">|</span> permit-calculate-other <span class="token punctuation">]</span> <span class="token operator">|</span> cost cost <span class="token operator">|</span> <span class="token builtin class-name">type</span> <span class="token builtin class-name">type</span> <span class="token operator">|</span> route-policy route-policy-name <span class="token punctuation">[</span> match-any <span class="token punctuation">]</span> <span class="token punctuation">]</span>
<span class="token comment">#	缺省情况下，在普通OSPF区域内的OSPF设备不产生缺省路由</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<ul>
<li><strong>always</strong>：无论本机是否存在激活的非本OSPF缺省路由，都会产生并发布一个描述缺省路由的LSA
<ul>
<li>如果配置了always参数，设备不再计算来自其他设备的缺省路由</li>
<li>如果没有配置always参数，本机路由表中必须有激活的非本OSPF缺省路由时才生成缺省路由的LSA</li>
</ul>
</li>
<li><strong>permit-calculate-other</strong>：本机必须存在激活的非本OSPF缺省路由时才会产生并发布一个缺省路由的LSA，且设备仍然计算来自于其他设备的缺省路由</li>
<li><strong>type type</strong>：指定外部路由的类型。整数形式，取值为1或2。缺省值是2
<ul>
<li>1：第一类外部路由</li>
<li>2：第二类外部路由</li>
</ul>
</li>
<li><strong>route-policy route-policy-name</strong>：通过路由策略，实现在路由表中有匹配的非OSPF产生的缺省路由表项时，按路由策略所配置的参数发布缺省路由</li>
<li><strong>match-any</strong>：通过路由策略，实现在路由表中有匹配的路由表项时，按路由策略所配置的参数发布缺省路由</li>
</ul>
<p><strong>2、指定Type3 Summary-LSA的缺省开销值</strong></p>
<pre class="line-numbers language-none"><code class="language-none">[Huawei-ospf-1] default-route-advertise summary cost cost<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<blockquote>
<p><strong><font color="blue">命令：[Huawei-ospf-1] default-route-advertise summary cost cost</font></strong></p>
<ul>
<li><strong>summary</strong>：发布指定缺省路由的Type3 LSA。在选用该参数时，必须首先使能VPN，否则路由不能发布</li>
<li><strong>cost cost</strong>：指定该LSA的开销值。取值范围是0～16777214，缺省值是1</li>
</ul>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">always参数：
	ASBR已经有缺省路由，执行default-route-advertise命令，将在整个OSPF区域中通告缺省路由0.0.0.0。
	ASBR没有缺省路由，执行default-route-advertise命令时按照以下需求选择是否配置always参数。
		如果配置always参数，无论ASBR是否有缺省路由都将在整个OSPF区域中通告缺省路由0.0.0.0，并且不再计算来自其他设备的缺省路由
		如果没有配置always参数，ASBR的路由表中必须有激活的非OSPF（BGP除外）缺省路由时才生成缺省路由的LSA
match-any参数：
	使用带match-any参数的路由策略时，如果有多条路由通过策略，选取最优者来生成缺省LSA。路由通过策略时，选取最优者的原则按照优先级从高到低的顺序如下：
		路由设置了type的优先于未设置的，如果都设置了type，值越小越优先
		路由设置了cost的优先于未设置的，如果都设置了cost，值越小越优先
		路由设置了tag的优先于未设置的， 如果都设置了tag，值越小越优先<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p><strong>import-route</strong>命令不能引入外部路由的缺省路由。当需要引入其他协议产生的缺省路由时，必须在ASBR上配置default-route-advertise命令，发布缺省路由到整个普通OSPF区域</p>
</blockquote>
<blockquote>
<p>OSPF路由域中在通告缺省路由前，会比较缺省路由的优先级。如果在某OSPF设备上同时配置了静态缺省路由，要使OSPF通告的缺省路由加入到当前的路由表中，则必须保证所配置的静态缺省路由的优先级比OSPF通告的缺省路由的优先级低</p>
</blockquote>
<h4 id="过滤lsa">过滤LSA</h4>
<h5 id="对发送的lsa进行过滤：">对发送的LSA进行过滤：</h5>
<blockquote>
<p><strong><font color="FF6600">在某些链路上通过对发送的LSA进行过滤，减少不必要的重传，节省带宽资源</font></strong></p>
</blockquote>
<p>通过对OSPF接口出方向的LSA进行过滤可以不向邻居发送无用的LSA，从而减少邻居LSDB的大小，提高网络收敛速度</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment">#	配置对OSPF接口出方向的LSA进行过滤：</span>
<span class="token punctuation">[</span>Huawei-GigabitEthernet0/0/1<span class="token punctuation">]</span> ospf filter-lsa-out <span class="token punctuation">&#123;</span> all <span class="token operator">|</span> <span class="token punctuation">&#123;</span> summary <span class="token punctuation">[</span> acl <span class="token punctuation">&#123;</span> acl-number <span class="token operator">|</span> acl-name <span class="token punctuation">&#125;</span> <span class="token punctuation">]</span> <span class="token operator">|</span> ase <span class="token punctuation">[</span> acl <span class="token punctuation">&#123;</span> acl-number <span class="token operator">|</span> acl-name <span class="token punctuation">&#125;</span> <span class="token punctuation">]</span> <span class="token operator">|</span> nssa <span class="token punctuation">[</span> acl <span class="token punctuation">&#123;</span> acl-number <span class="token operator">|</span> acl-name <span class="token punctuation">&#125;</span> <span class="token punctuation">]</span> <span class="token punctuation">&#125;</span> <span class="token punctuation">&#125;</span>
<span class="token comment">#	对于已经发送的LSA，要到3600秒才能达到老化时间</span>

<span class="token comment">#	all：对除Grace LSA外的所有LSA进行过滤</span>
<span class="token comment">#	summary：对Network Summary LSA（Type3 LSA）进行过滤</span>
<span class="token comment">#	ase：对AS External LSA（Type5 LSA）进行过滤</span>
<span class="token comment">#	nssa：对NSSA LSA（Type7 LSA）进行过滤</span>
<span class="token comment">#	acl acl-number：指定基本访问控制列表编号。整数形式，取值范围是2000～2999</span>
<span class="token comment">#	acl acl-name：指定访问控制列表名称。不支持空格，长度范围是1～32，以英文字母a～z或A～Z开始</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="对abr-type3-lsa进行过滤：">对ABR Type3 LSA进行过滤：</h5>
<blockquote>
<p>对区域内出、入方向ABR Type3 LSA[Summary LSA]设置过滤条件，只有通过过滤的LSA才能被发布和接收</p>
</blockquote>
<blockquote>
<p>通过对区域内的LSA进行过滤可以不向邻居发送无用的LSA，从而减少LSDB的大小，提高网络收敛速度</p>
</blockquote>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment">#	配置对区域内出方向的Type3 LSA进行过滤：</span>
<span class="token punctuation">[</span>Huawei-ospf-1-area-0.0.0.1<span class="token punctuation">]</span> filter <span class="token punctuation">&#123;</span> acl-number <span class="token operator">|</span> acl-name acl-name <span class="token operator">|</span> ip-prefix ip-prefix-name <span class="token operator">|</span> route-policy route-policy-name <span class="token punctuation">&#125;</span> <span class="token builtin class-name">export</span>
<span class="token comment">#	配置对区域内入方向的Type3 LSA进行过滤</span>
<span class="token punctuation">[</span>Huawei-ospf-1-area-0.0.0.1<span class="token punctuation">]</span> filter <span class="token punctuation">&#123;</span> acl-number <span class="token operator">|</span> acl-name acl-name <span class="token operator">|</span> ip-prefix ip-prefix-name <span class="token operator">|</span> route-policy route-policy-name <span class="token punctuation">&#125;</span> <span class="token function">import</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="ospf-database-overflow">OSPF Database Overflow:</h5>
<blockquote>
<p><strong><font color="FF6600">OSPF要求同一个区域中的路由器保存相同的LSDB，一些路由器由于系统资源有限，不能再承载如此多的路由信息，这种状态就被称为数据库超限</font>	[OSPF Database Overflow]</strong></p>
</blockquote>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment">#	对于路由信息不断增加导致路由器系统资源耗尽而失效的问题，可以通过配置Stub或NSSA区域来解决，但Stub或NSSA区域的方案不能解决动态路由增长导致的数据库超限问题</span>
<span class="token comment">#	为了解决数据库超限引发的问题，通过设置LSDB中External LSA的最大条目数，可以动态限制链路数据库的规模</span>
<span class="token punctuation">[</span>Huawei-ospf-1<span class="token punctuation">]</span> lsdb-overflow-limit number
	- number：指定LSDB中External LSA的最大条目数。整数形式，取值范围是1～1000000。<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="避免ospf-database-overflow工作原理">避免OSPF Database Overflow工作原理</h5>
<p>为了避免数据库超限，可以设置路由器上非缺省外部路由数量的上限</p>
<blockquote>
<p><strong><font color="blue">OSPF网络中所有路由器都配置相同的上限值，只要路由器上外部路由的数量达到该上限，路由器就进入Overflow状态，并同时启动Overflow状态定时器，路由器在定时器超过5秒后自动退出Overflow状态</font></strong></p>
</blockquote>
<img src="./IGP高级特性/Overflow数据库超限处理.png" style="zoom:80%;" />
<h3 id="ospf其他特性">OSPF其他特性</h3>
<h4 id="ospf多进程">OSPF多进程</h4>
<blockquote>
<p><strong><font color="orange">OSPF支持多进程，在同一台路由器上可以运行多个不同的OSPF进程，它们之间互不影响，彼此独立。不同OSPF进程之间的路由交互相当于不同路由协议之间的路由交互</font></strong></p>
</blockquote>
<blockquote>
<p><strong><font color="black">路由器的一个接口只能属于某一个OSPF进程</font></strong></p>
</blockquote>
<h4 id="ospf与bgp联动">OSPF与BGP联动:</h4>
<blockquote>
<p><strong><font color="redorange">当有新的设备加入到网络中，或者设备重启时，可能会出现在BGP收敛期间内网络流量丢失的现象。这是由于IGP收敛速度比BGP快而造成的</font></strong></p>
</blockquote>
<ul>
<li>通过使能OSPF与BGP联动特性，可以解决流量丢失问题</li>
<li>使能了OSPF与BGP联动特性的设备会在设定的<font color="blue">联动时间内保持为Stub路由器</font>，也就是说，该设备发布的LSA中的链路度量值为最大值[65535]，从而告知其它OSPF设备不要使用这个路由器来转发数据</li>
</ul>
<img src="./IGP高级特性/OSPF与BGP联动后的收敛.png" style="zoom:67%;" />
<ul>
<li>配置Stub路由器是一种特殊的路由选路，配置了Stub路由器的路径不被优选</li>
<li>实现方法是将度量值设为最大（65535），尽量避免数据从此路由器转发。用于保护此路由器链路，通常使用在升级等维护操作的场景</li>
</ul>
<blockquote>
<p><strong><font color="FF6600">命令：[Huawei-ospf-1] stub-router [ on-startup [ interval ] ]</font></strong></p>
<ul>
<li>
<p><strong>on-startup [ interval ]</strong>：设备在发生重启或故障时保持为Stub路由器的时间间隔。取值范围是5～65535s，缺省值是500s</p>
<blockquote>
<p><font color="blue">如果未配置on-startup参数，则表示该设备始终保持为Stub路由器，即所有来自这个设备的路由条目Cost值均设为65535</font></p>
</blockquote>
<blockquote>
<p><font color="blue">如果配置了on-startup参数，则表示该设备仅在重启或者故障时保持为Stub路由器，保持时间由interval参数决定。此时若未配置interval参数，则使用interval的缺省值500s</font></p>
</blockquote>
</li>
</ul>
</blockquote>
<h4 id="ospf转发地址">OSPF转发地址:</h4>
<blockquote>
<p><strong><font color="FF6600">FA[Forwarding Address，转发地址]：到达所通告的目的地的数据包应该被转发到的地址，如果转发地址为0.0.0.0，那么数据包将被转发到始发ASBR上</font></strong></p>
</blockquote>
<img src="./IGP高级特性/FA转发地址.png" style="zoom:50%;" />
<h5 id="fa的取值">FA的取值:</h5>
<ul>
<li>
<ul>
<li>
<p><font color="blue">当ASBR引入外部路由时，若Type5 LSA中的FA字段为0，表示路由器认为到达目的网段的数据包应该发往该ASBR</font></p>
</li>
<li>
<p><font color="blue">若Type5 LSA中的FA字段不为0，表示路由器认为到达目的网段的数据包应该发往这个FA所标识的设备</font></p>
</li>
</ul>
</li>
<li>
<p><font color="black">当以下条件全部满足时，FA字段才可以被设置为非0</font></p>
<ul>
<li>ASBR在其连接外部网络的接口（外部路由的出接口）上激活了OSPF</li>
<li>该接口没有被配置为Silent-Interface</li>
<li>该接口的OSPF网络类型为Broadcast或NBMA</li>
<li>该接口的IP地址在OSPF配置的network命令指定的网段范围内</li>
</ul>
</li>
<li>
<p><font color="blue">到达FA地址的路由必须是OSPF区域内部路由或区域间路由，这样接收到该外部LSA的路由器才能够加载该LSA进入路由表。加载的外部LSA生成的路由条目下一跳与到达FA地址的下一跳相</font></p>
</li>
</ul>
<p><strong>NSSA区域Type7 LSA转化为Type5 LSA：</strong></p>
<ul>
<li><font color="orange">为了将NSSA区域引入的外部路由发布到其它区域，要把Type7 LSA转化为Type5 LSA以便在整个OSPF网络中通告。缺省情况下，转换路由器是NSSA区域中Router ID最大的区域边界路由器[ABR]</font></li>
<li><font color="orange">LSA头部Options字段中的P-bit[Propagate bit]用于告知转化路由器该条Type7 LSA是否需要转化为Type5 LSA只有P-bit置位并且FA不为0的Type7 LSA才能转化为Type5 LSA</font></li>
</ul>
<p><strong>区域边界路由器产生的Type7 LSA缺省路由不会置位P-bit</strong></p>
<h2 id="is-is高级特性">IS-IS高级特性</h2>
<h3 id="is-is快速收敛">IS-IS快速收敛</h3>
<blockquote>
<p><strong><font color="FF6600">IS-IS快速收敛是为了提高路由的收敛速度而做的扩展特性，包括：I-SPF [ Incremental SPF，增量最短路径优先算法 ]、PRC、智能定时器、LSP快速扩散</font></strong></p>
</blockquote>
<ul>
<li><font color="blue">IS-IS支持故障恢复快速收敛，例如通过IS-IS Auto FRR实现备份链路的快速切换，也可以与BFD联动实现对故障的快速感知</font></li>
</ul>
<h4 id="i-spf">I-SPF</h4>
<blockquote>
<p><strong><font color="black">I-SPF的工作原理：当网络拓扑改变的时候，只对受影响的节点进行路由计算，而不是对全部节点重新进行路由计算，从而加快了路由的计算</font></strong></p>
</blockquote>
<img src="./IGP高级特性/I-SPF示例.png" style="zoom:67%;" />
<ul>
<li><strong><font color="orange">使用SPF算法进行路由计算：当网络拓扑中有一个节点发生变化时，SPF算法需要重新计算网络中的所有节点，计算时间长，占用过多的CPU资源，影响整个网络的收敛速度</font></strong></li>
<li><strong><font color="orange">I-SPF改进了SPF算法，除了第一次SPF计算时需要计算全部节点外，之后每次都通过I-SPF计算受到影响的节点，而最后生成的最短路径树与原来的算法所计算的结果相同，大大降低了CPU的占用率，提高了网络收敛速度</font></strong></li>
<li>在IS-IS网络中，I-SPF和PRC结合使用。
<ul>
<li>如果I-SPF计算后的最短路径树改变，PRC会只处理那个变化的节点上的所有路由</li>
<li>如果经过I-SPF计算后的最短路径树并没有变化，则PRC只处理变化的叶子信息。比如一个节点使能一个IS-IS接口，则整个网络拓扑的最短路径树是不变的，这时PRC只更新这个节点的接口路由，从而节省CPU占用率</li>
</ul>
</li>
</ul>
<h4 id="lsp快速扩散">LSP快速扩散:</h4>
<ul>
<li>LSP快速扩散：此特性可以加快LSP的扩散速度。
<ul>
<li>正常情况下，当IS-IS路由器收到其它路由器发来的LSP时，如果此LSP比本地LSDB中相应的LSP要新，则更新LSDB中的LSP，并用一个定时器定期将LSDB内已更新的LSP扩散出去</li>
<li>LSP快速扩散特性改进了这种方式，使能了此特性的设备收到一个或多个较新的LSP时，在路由计算之前，先将小于指定数目的LSP扩散出去，加快LSDB的同步过程。这种方式在很大程度上可以提高整个网络的收敛速度</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment">#	     配置LSP快速扩散</span>
<span class="token punctuation">[</span>Huawei-isis-1<span class="token punctuation">]</span> flash-flood <span class="token punctuation">[</span> lsp-count <span class="token operator">|</span> max-timer-interval interval <span class="token operator">|</span> <span class="token punctuation">[</span> level-1 <span class="token operator">|</span> level-2 <span class="token punctuation">]</span> <span class="token punctuation">]</span>
<span class="token comment">#	lsp-count：指定每个接口一次扩散LSP的最大数量。整数形式，取值范围是1～15。缺省值是5。</span>
<span class="token comment">#	max-timer-interval interval：指定LSP扩散的最大间隔时间。取值范围是10～50000毫秒。缺省值是10毫秒</span>
<span class="token comment">#	level-1：表示在Level-1中使能此特性。如果命令中没有指定级别，则缺省同时在Level-1和Level-2中使能此功能</span>
<span class="token comment">#	level-2：表示在Level-2中使能此特性。同上</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="is-is路由控制">IS-IS路由控制</h3>
<h4 id="等价路由">等价路由</h4>
<p>当IS-IS网络中有多条冗余链路时，可能会出现多条等价路由，此时可以采取两种方式：</p>
<ul>
<li>配置负载分担。流量会被均匀的分配到每条链路上
<ul>
<li>该方式可以提高网络中链路的利用率及减少某些链路负担过重造成阻塞发生的情况。但是由于对流量转发具有一定的随机性，因此可能不利于对业务流量的管理</li>
</ul>
</li>
<li>配置等价路由优先级。针对等价路由中的每一条路由，明确指定其优先级，优先级高的路由将被优选，优先级低的路由可以作为备用链路
<ul>
<li>当IS-IS网络中有多条冗余链路时，可能会出现多条等价路由，即达到某一目的网段有多条等开销路径。配置等价路由优先级可以在不修改原有配置的基础上，指定某条路由被优选，便于业务的管理，同时提高网络的可靠性</li>
</ul>
</li>
</ul>
<p>注意：配置等价路由优先级后，IS-IS设备在转发到达目的网段的流量时，将不采用负载分担方式，而是将流量转发到优先级最高的下一跳</p>
<h5 id="配置is-is对等价路由的处理方式">配置IS-IS对等价路由的处理方式</h5>
<p><strong>1、配置IS-IS路由负载分担</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>Huawei-isis-1<span class="token punctuation">]</span> maximum load-balancing number
<span class="token comment">#	配置在负载分担方式下的等价路由的最大数量。</span>
<span class="token comment">#	number：指定在负载分担方式下等价路由的最大数量。不同设备型号取值不同</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p><strong>2、配置IS-IS等价路由的优先级</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>Huawei-isis-1<span class="token punctuation">]</span> nexthop ip-address weight value
<span class="token comment">#	缺省情况下，不设置IS-IS等价路由的优先级。value值越小，表示优先级越高。</span>
<span class="token comment">#	ip-address：指定下一跳的IP地址</span>
<span class="token comment">#	weight value：指定下一跳权重。value越小则优先级越高。value是整数形式，取值范围是1～254</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>当组网中存在的等价路由数量大于<strong>maximum load-balancing</strong>命令配置的等价路由数量时，按照下面原则选取有效路由进行负载分担：</p>
<ol>
<li><strong>路由优先级</strong>：选取优先级小[优先级高]的路由进行负载分担</li>
<li><strong>下一跳设备的System ID</strong>：如果路由的优先级相同，则比较下一跳设备的System ID，选取System ID小的路由进行负载分担</li>
<li><strong>本地设备出接口索引</strong>：如果路由优先级和下一跳设备的System ID都相同，则比较出接口的接口索引，选取接口索引较小的路由进行负载分担</li>
</ol>
<h4 id="缺省路由">缺省路由</h4>
<p>在IS-IS中，主要通过以下3种方式控制缺省路由的生成和发布。</p>
<ul>
<li>在Level-1-2设备上，控制其产生的Level-1 LSP中ATT位的置位情况</li>
<li>在Level-1设备上，通过配置使其即使收到ATT位置位的Level-1 LSP也不会自动产生缺省路由</li>
<li>在IS-IS中发布缺省路由</li>
</ul>
<h5 id="lsp的报文格式：">LSP的报文格式：</h5>
<p><strong>ATT [Attachment]</strong>：<font color="blue">由Level-1-2路由器产生，用来指明始发路由器是否与其它区域相连。此字段有4bit，华为数通产品只使用了其中1bit</font></p>
<img src="./IGP高级特性/LSP的报文格式.png" style="zoom: 60%;" />
<h5 id="通过设置att位控制缺省路由生成">通过设置ATT位控制缺省路由生成:</h5>
<ul>
<li>
<p><font color="FF1234">IS-IS规定，如果<strong>IS-IS Level-1-2</strong>设备根据LSDB判断通过Level-2区域比Level-1区域能够到达更多的区域，该设备会在所发布的Level-1 LSP内将ATT位置位</font></p>
</li>
<li>
<p><font color="FF1234">对于<strong>收到ATT位置位的LSP报文的Level-1设备</strong>，会生成一条目的地为发送该LSP的Level-1-2设备地址的缺省路由</font></p>
</li>
</ul>
<blockquote>
<p><strong><font color="orange">在实际应用中，可以根据需要对ATT比特位进行手动配置以更好地为网络服务:</font></strong></p>
</blockquote>
<p><strong>1、[Level-1-2设备]	设置IS-IS LSP报文的ATT比特位置位规则</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>Huawei-isis-1<span class="token punctuation">]</span> attached-bit advertise <span class="token punctuation">&#123;</span> always <span class="token operator">|</span> never <span class="token punctuation">&#125;</span>
<span class="token comment">#	缺省情况下，Level-1-2设备发布的LSP的ATT位根据缺省置位规则来决定置位情况。</span>
	-always:指定ATT位永远置位，收到该LSP的Level-1设备会生成缺省路由
	-never:指定ATT位永不置位，可以避免Level-1设备生成缺省路由，减小路由表的规模
<span class="token comment">#	虽然ATT位同时在Level-1 LSP和Level-2 LSP中进行了定义，但是它只会在Level-1 LSP中被置位，并且只有Level-1-2设备会设置这个字段，因此，该命令仅对Level-1-2设备生效</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>2、[Level-1设备]	控制Level-1设备不因为ATT位下发缺省路由到路由表</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>Huawei-isis-1<span class="token punctuation">]</span> attached-bit avoid-learning
<span class="token comment">#	缺省情况下，IS-IS按ATT位缺省使用规则生成缺省路由</span>
<span class="token comment">#	配置Level-1设备不将缺省路由下发到路由表，有以下两种方式可以实现:</span>
	-在Level-1-2设备上配置attached-bit advertise never命令，使得其不会发布ATT位置位的LSP
	-在与Level-1-2设备相连的Level-1设备上配置attached-bit avoid-learning命令
<span class="token comment">#	attached-bit avoid-learning命令适用于需要针对指定设备配置的情况</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h5 id="is-is发布缺省路由">IS-IS发布缺省路由</h5>
<p><font color="FF6600"><strong>具有外部路由的边界设备上配置IS-IS发布缺省路由可以使该设备在IS-IS路由域内发布一条0.0.0.0/0的缺省路由</strong></font></p>
<p>在执行此配置后，IS-IS域内的其他设备在转发流量时，将所有去往外部路由域的流量首先转发到该设备，然后通过该设备去往外部路由域</p>
<ul>
<li>网络中部署了IS-IS和其他路由协议时，<strong>为了实现IS-IS域内的流量可以到达IS-IS域外</strong>，通常有如下两种方式：
<ul>
<li>在边界设备上配置IS-IS设备向IS-IS域发布缺省路由，该方式不需要学习外部路由</li>
<li>在边界设备上将其他路由域的路由引入到IS-IS中</li>
</ul>
</li>
</ul>
<p><strong>配置运行IS-IS的设备生成缺省路由：</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>Huawei-isis-1<span class="token punctuation">]</span> default-route-advertise <span class="token punctuation">[</span> always <span class="token operator">|</span> match default <span class="token operator">|</span> route-policy route-policy-name <span class="token punctuation">]</span> <span class="token punctuation">[</span> cost cost <span class="token operator">|</span> tag tag <span class="token operator">|</span> <span class="token punctuation">[</span> level-1 <span class="token operator">|</span> level-1-2 <span class="token operator">|</span> level-2 <span class="token punctuation">]</span> <span class="token punctuation">]</span> <span class="token punctuation">[</span> avoid-learning <span class="token punctuation">]</span>
<span class="token comment">#	缺省情况下，运行IS-IS协议的设备不生成缺省路由</span>
	-always：指定设备无条件的发布缺省路由，且发布的缺省路由中将自己作为下一跳
	-match default:如果路由表中存在其他路由协议或其它IS-IS进程生成的缺省路由，则在LSP中发布该缺省路由
	-route-policy route-policy-name:指定路由策略名称。当该边界设备的路由表中存在满足路由策略的外部路由时，才向IS-IS域发布缺省路由，避免由于链路故障等原因造成该设备已经不存在某些重要的外部路由时，仍然发布缺省路由从而造成路由黑洞。此处的路由策略不影响IS-IS引入外部路由
	-cost cost：指定缺省路由的开销值。整数形式。取值范围根据cost-style而定：当cost-style为narrow、narrow-compatible或compatible时，取值范围是0～63；当cost-style为wide或wide-compatible时，取值范围是0～4261412864
	-tag tag：指定发布的缺省路由的标记值。只有当IS-IS的开销类型为wide、wide-compatible或compatible时，发布的LSP中才会携带tag值。取值范围为1～4294967295
	-level-1：指定发布的缺省路由级别为Level-1。如果不指定级别，则默认为生成Level-2级别的缺省路由
	-level-2：指定发布的缺省路由级别为Level-2。如果不指定级别，则默认为生成Level-2级别的缺省路由
	-level-1-2：指定发布的缺省路由级别为Level-1-2。如果不指定级别，则默认为生成Level-2级别的缺省路由
	-avoid-learning：避免IS-IS进程学到其他路由协议或其它IS-IS进程生成的缺省路由并添加到路由表。如果路由表中已存在学到的缺省路由为活跃状态，则将此路由置为不活跃状态<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ul>
<li>配置该命令后，IS-IS域内所有去往外部的流量将首先会被转发到该设备来进行转发。相比于在每台设备上配置静态缺省路由，使用该命令可以简化操作，即只需在边界设备配置即可。此外，该命令是动态发布缺省路由，使用更加灵活，有多种发布缺省路由的方式可供选择</li>
<li>如果在Level-1设备上配置了该命令，那么该设备只会向Level-1区域发布缺省路由，不会将缺省路由发布到Level-2区域</li>
</ul>
<h4 id="is-is多实例和多进程">IS-IS多实例和多进程</h4>
<blockquote>
<p><font color=" FF0033 ">IS-IS多实例是指在同一台路由器上，可以配置多个VPN实例与多个IS-IS进程相关联</font></p>
</blockquote>
<blockquote>
<p><font color=" FF0033 ">IS-IS多进程指在同一个VPN下  [或者同在公网下]，可以创建多个IS-IS进程，每个进程之间互不影响，彼此独立。不同进程之间的路由交互相当于不同路由协议之间的路由交互</font></p>
</blockquote>
<p>网络中可能需要同时承载不同的业务，为保证各业务的安全性，需要将业务进行隔离，此时，可以配置与VPN实例绑定</p>
<ul>
<li>IS-IS多实例和多进程的特点如下：
<ul>
<li>IS-IS多进程共用同一个全局路由表。而IS-IS多实例使用VPN中的路由表，并且每个VPN都有自己单独的路由表</li>
<li>IS-IS多进程允许为一个指定的IS-IS进程关联一组接口，从而保证该进程进行的所有协议操作都仅限于这一组接口。这样，就可以实现一台路由器有多个IS-IS协议进程，每个进程负责唯一的一组接口</li>
<li>IS-IS进程在创建时可以选择绑定一个VPN实例，于是这个IS-IS进程就与此VPN实例相关联，并且只接收和处理此VPN实例内的事件。当VPN实例删除时，IS-IS进程也会跟着被删除</li>
</ul>
</li>
</ul>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span> isis <span class="token punctuation">[</span> process-id <span class="token punctuation">]</span> <span class="token punctuation">[</span> vpn-instance vpn-instance-name <span class="token punctuation">]</span>
	-process-id:指定IS-IS进程号。如果不指定进程，则启动进程号为1的IS-IS进程，取值范围是1～65535。缺省值是1
	-vpn-instance vpn-instance-name：指定VPN实例名。如果不指定此参数，则就不会配置VPN实例与相应的IS-IS进程相关联<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<h5 id="lsp分片">LSP分片</h5>
<blockquote>
<p><strong><font color="FF6600">当IS-IS要发布的PDU中信息量太大时，IS-IS路由器将会生成多个LSP分片，用来携带更多的IS-IS信息</font></strong></p>
</blockquote>
<img src=".\IGP高级特性\IS-IS_LSP的格式.png" style="zoom: 50%;" />
<p>IS-IS LSP分片由LSP ID中的分片号	[LSP Number]字段进行标识，这个字段的长度是1Byte。因此，一个IS-IS进程最多可产生256个LSP分片，携带的信息量有限</p>
<h5 id="lsp分片扩展工作原理">LSP分片扩展工作原理:</h5>
<blockquote>
<p>在IS-IS中，每个系统ID都标识一个系统，每个系统都最多可生成256个LSP分片。通过增加附加系统ID，可以最多配置50个虚拟系统，从而使得IS-IS进程最多可生成13056个LSP分片</p>
</blockquote>
<p>IS-IS路由器可以在两种模式下运行LSP分片扩展特性：</p>
<img src="./IGP高级特性/两种模式下运行LSP分片扩展特性.png" style="zoom:80%;" />
<ul>
<li>Mode-1工作原理：
<ul>
<li>虚拟系统参与路由SPF计算，初始系统发布的LSP中携带了到每个虚拟系统的链路信息。虚拟系统发布的LSP也包含到初始系统的链路信息。网络中虚拟系统看起来与初始系统相连的真实路由器是一样的</li>
<li>这种方式是为了兼容不支持分片扩展的老版本所做的一个过渡模式。老版本IS-IS无法识别24号TLV，所以虚拟系统的LSP必须表现的像一个普通IS-IS发出的报文</li>
<li>注意事项：
<ul>
<li>虚拟系统的LSP中包含和原LSP中相同的区域地址和过载标志位，其它特性的TLV，也必须保持一致</li>
<li>虚拟系统的邻居信息指向初始系统，metric为最大值减1；初始系统的邻居信息指向虚拟系统，metric必须为0。这样就保证了其它路由器在进行路由计算的时候，虚拟系统一定会成为初始系统的下游节点</li>
</ul>
</li>
</ul>
</li>
<li>Mode-2工作原理：
<ul>
<li>虚拟系统不参与路由SPF计算，网络中所有路由器都知道虚拟系统生成的LSP实际属于初始系统</li>
<li>在该模式下工作的IS-IS，可以识别24号TLV的内容，并作为计算树和路由的依据</li>
</ul>
</li>
</ul>
<h5 id="lsp分片扩展的基本配置命令：">LSP分片扩展的基本配置命令：</h5>
<p><strong>1、使能IS-IS进程的LSP分片扩展：</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>Huawei-isis-1<span class="token punctuation">]</span>lsp-fragments-extend <span class="token punctuation">[</span><span class="token punctuation">[</span> level-1 <span class="token operator">|</span> level-2<span class="token operator">|</span> level-1-2 <span class="token punctuation">]</span><span class="token operator">|</span><span class="token punctuation">[</span>mode-1 <span class="token operator">|</span>mode-2<span class="token punctuation">]</span> <span class="token punctuation">]</span> 
<span class="token comment">#	缺省情况下，设备未使能IS-IS进程的LSP分片扩展功能</span>
<span class="token comment">#	配置LSP分片扩展时，如果不指定mode和level级别，则默认为mode-1和level-1-2</span>
	-level-1：指定在Level-1级别使能分片扩展
	-level-2：指定在Level-2级别使能分片扩展
	-level-1-2：指定在Level-1-2级别使能分片扩展
	-mode-1：该模式可以兼容以前老版本不支持LSP分片扩展特性的情况
	-mode-2：该模式要求所有路由器都支持LSP分片扩展特性<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>2、配置一个虚拟系统：</strong></p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>Huawei-isis-1<span class="token punctuation">]</span> virtual-system virtual-system-id 
<span class="token comment">#	缺省情况下，设备没有配置虚拟系统</span>
<span class="token comment">#	为了使设备生成扩展LSP分片，应至少配置一个虚拟系统的系统ID。这个虚拟系统的系统ID在整个路由域中必须唯一</span>
<span class="token comment">#	一个IS-IS进程最多可配置50个虚拟系统的System ID</span>
	-virtual-system-id：指定IS-IS进程的虚拟系统ID。长度是6字节（48比特），格式是XXXX.XXXX.XXXX<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>以上两条命令是配合使用的，只有使能了LSP分片扩展，并用reset isis all命令重启了IS-IS进程后，配置的虚拟系统ID才会生效</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">十二惊惶</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://shierjinghuang.github.io/2024/01/01/IGP%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7/">https://shierjinghuang.github.io/2024/01/01/IGP%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">十二惊惶</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B/">
                                    <span class="chip bg-color">网络工程</span>
                                </a>
                            
                                <a href="/tags/IGP/">
                                    <span class="chip bg-color">IGP</span>
                                </a>
                            
                                <a href="/tags/%E8%B7%AF%E7%94%B1%E4%B8%8E%E4%BA%A4%E6%8D%A2%E8%BF%9B%E9%98%B6/">
                                    <span class="chip bg-color">路由与交换进阶</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2024/01/01/%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E7%9B%B8%E5%85%B3%E6%95%B4%E7%90%86%E6%B1%87%E6%80%BB/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/18.jpg" class="responsive-img" alt="网络工程相关整理汇总">
                        
                        <span class="card-title">网络工程相关整理汇总</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            作为博客关于网络方向记录的汇总，实时更新，涉及计算机网络、华为ICT及Cisco相关知识，已更新至IGP高级特性，更新时间2025/3/30
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2024-01-01
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E7%BD%91%E7%BB%9C%E5%B7%A5%E7%A8%8B%E7%9B%B8%E5%85%B3/" class="post-category">
                                    网络工程相关
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/HCIP/">
                        <span class="chip bg-color">HCIP</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2023/10/02/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%80%81%E5%8A%BF%E6%84%9F%E7%9F%A5%E4%B8%8E%E7%AE%A1%E6%8E%A7%E5%B9%B3%E5%8F%B0/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/21.jpg" class="responsive-img" alt="网络安全态势感知与管控平台">
                        
                        <span class="card-title">网络安全态势感知与管控平台</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-10-02
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" class="post-category">
                                    网络安全
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">
                        <span class="chip bg-color">网络安全</span>
                    </a>
                    
                    <a href="/tags/%E6%80%81%E5%8A%BF%E6%84%9F%E7%9F%A5/">
                        <span class="chip bg-color">态势感知</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2025</span>
            
            <a href="/about" target="_blank">十二惊惶</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">504.3k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/blinkfox" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:572688347@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=572688347" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 572688347" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
