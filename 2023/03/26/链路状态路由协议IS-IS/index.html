<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="链路状态路由协议IS-IS, 十二惊惶">
    <meta name="description" content="S-IS是一种链路状态路由协议，是ISO定义的OSI协议栈中的CLNS无连接网络服务的一部分，是一种动态路由协议">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>链路状态路由协议IS-IS | 十二惊惶</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    


    <!-- bg-cover style     -->



<link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
<link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
<link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
<link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
<link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
<link rel="stylesheet" type="text/css" href="/css/matery.css">
<link rel="stylesheet" type="text/css" href="/css/my.css">
<link rel="stylesheet" type="text/css" href="/css/dark.css" media="none" onload="if(media!='all')media='all'">




    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
    <link rel="stylesheet" href="/css/post.css">




    



    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="十二惊惶" type="application/atom+xml">
</head>


<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/1.jpg" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">十二惊惶</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>标签</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>留言板</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
  <li>
    <a href="javascript:;" class="waves-effect waves-light" onclick="switchNightMode()" title="深色/浅色模式" >
      <i id="sum-moon-icon" class="fas fa-sun" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/1.jpg" class="logo-img circle responsive-img">
        
        <div class="logo-name">十二惊惶</div>
        <div class="logo-desc">
            
            犁牛之子骍且角，虽欲勿用，山川其舍诸
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			标签
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			留言板
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://gitee.com/Im-so-scared-2/shier_jinghuang" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>十二惊惶
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://gitee.com/Im-so-scared-2/shier_jinghuang" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="十二惊惶" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/16.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">链路状态路由协议IS-IS</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/HCIP/">
                                <span class="chip bg-color">HCIP</span>
                            </a>
                        
                            <a href="/tags/IS-IS/">
                                <span class="chip bg-color">IS-IS</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/HCIP/" class="post-category">
                                HCIP
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2023-03-26
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2023-04-09
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    6.1k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    23 分
                </div>
                

                
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="far fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.min.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <center><h1>中间系统到中间系统 IS-IS</h1></center>
[TOC]

<blockquote>
<p><font color="blue">IS-IS是ISO为CLNP[<font color="black">ConnectionLessNetwork Protocol，无连接网络协议]</font>设计的一种动态路由协议</font></p>
</blockquote>
<p>随着TCP/IP协议的流行，为了提供对IP路由的支持，IETF在RFC1195中对IS-IS进行了扩充和修改，使它能够同时应用在TCP/IP和OSI环境中，我们将扩展后的IS-IS称为<strong>集成IS-IS</strong></p>
<h2 id="IS-IS的基本概念"><a href="#IS-IS的基本概念" class="headerlink" title="IS-IS的基本概念"></a>IS-IS的基本概念</h2><p>IS-IS概述：IS-IS是一种<font color="red">链路状态路由协议</font>，是ISO定义的OSI协议栈中的CLNS是ConnectionLess Network Service，无连接网络服务的一部分</p>
<ul>
<li><p>CLNS (CLNS也是一种无连接的网络) 由以下三个部分组成</p>
<ul>
<li><p>CLNP：类似于TCP/IP中的IP协议。</p>
</li>
<li><p>IS-IS：类似于TCP/IP中的OSPF</p>
</li>
<li><p>ES-IS：类似于TCP/IP中的ARP，ICMP等</p>
</li>
</ul>
</li>
<li><p>ES：End System，终端系统，类似于IP网络环境中的主机</p>
</li>
<li><p>ES-IS：End System to Intermediate System，终端系统到中间系统</p>
</li>
</ul>
<h3 id="IS-IS地址结构"><a href="#IS-IS地址结构" class="headerlink" title="IS-IS地址结构"></a>IS-IS地址结构</h3><h5 id="NSAP："><a href="#NSAP：" class="headerlink" title="NSAP："></a>NSAP：</h5><blockquote>
<p><font color="blue">NSAP Network Service Access Point，网络服务访问点</font>，是OSI协议栈中用于定位资源的地址，主要用于提供网络层和上层应用之间的接口</p>
</blockquote>
<ul>
<li>NSAP包括IDP（Initial Domian Part）及DSP（Domian Specific Part）如下图所示：</li>
</ul>
<img src="https://shierjinghuang.github.io/2023/03/26/链路状态路由协议IS-IS/IS-IS地址结构.png" style="zoom:80%;" />

<center>IS-IS地址结构</center>
- IDP，由AFI(Authority and Format Identifier)与IDI(Initial Domain Identifier)两部分组成，AFI表示地址分配机构和地址格式，IDI用来标识域
- DSP相当于IP地址中的子网号和主机地址。由High Order DSP、System ID和SEL三个部分组成，High Order DSP用来分割区域，System ID用来区分主机，SEL（NSAP Selector）用来指示服务类型

<h5 id="NET："><a href="#NET：" class="headerlink" title="NET："></a>NET：</h5><blockquote>
<p><font color="blue">NET 网络实体名称：是OSI协议栈中设备的网络层信息，主要用于路由计算</font>，由区域地址Area ID和System ID组成，可以看作是特殊的NSAP</p>
</blockquote>
<ul>
<li><p>NET的长度与NSAP的相同，最长为20Byte，最短为8Byte</p>
</li>
<li><p>在IP网络中运行IS-IS时，只需配置NET，根据NET地址设备可以获取到Area ID以及System ID。</p>
</li>
<li><p><font color="blue">Area ID被称为区域地址</font>，由IDP和DSP中的High Order DSP组成，能标识路由域，也标识路由域中的区域</p>
<ul>
<li>一般情况下，一个路由器只需要配置一个区域地址，且同一区域中所有节点的区域地址都要相同。为了支持区域的平滑合并、分割及转换，缺省情况下，一个IS-IS进程下最多可配置3个区域地址。</li>
</ul>
</li>
<li><p>System ID用来在区域内唯一标识主机或路由器。在设备的实现中，它的长度固定为6Byte。</p>
<ul>
<li>System ID通常由root ID扩展得到</li>
</ul>
</li>
</ul>
<h3 id="IS-IS拓扑结构"><a href="#IS-IS拓扑结构" class="headerlink" title="IS-IS拓扑结构"></a>IS-IS拓扑结构</h3><ul>
<li>IS-IS在自治系统内采用骨干区域与非骨干区域两级的分层结构：<ul>
<li>Level-1路由器部署在非骨干区域</li>
<li>Level-2路由器和Level-1-2路由器部署在骨干区域</li>
</ul>
</li>
<li>每一个非骨干区域都通过Level-1-2路由器与骨干区域相连</li>
</ul>
<p><strong>补充IS-IS与OSPF的区别：</strong></p>
<ul>
<li>在IS-IS中，每个路由器都只属于一个区域；而在OSPF中，一个路由器的不同接口可以属于不同的区域</li>
<li>在IS-IS中，单个区域没有骨干与非骨干区域的概念；而在OSPF中，Area0被定义为骨干区域</li>
<li>在IS-IS中，Level-1和Level-2级别的路由都采用SPF算法，分别生成最短路径树SPT；而在OSPF中，只有在同一个区域内才使用SPF算法，区域之间的路由需要通过骨干区域来转发</li>
</ul>
<h4 id="IS-IS路由器的分类"><a href="#IS-IS路由器的分类" class="headerlink" title="IS-IS路由器的分类"></a>IS-IS路由器的分类</h4><img src="https://shierjinghuang.github.io/2023/03/26/链路状态路由协议IS-IS/IS-IS路由器分类示意图.png" style="zoom:80%;" />

<h5 id="Level-1路由器"><a href="#Level-1路由器" class="headerlink" title="Level-1路由器"></a>Level-1路由器</h5><p>Level-1路由器是一种<font color="red">IS-IS区域内部路由器</font>，它<font color="blue">只与属于同一区域的Level-1和Level-1-2路由器形成邻接关系，这种邻接关系称为Level-1邻接关系</font></p>
<ul>
<li><p>Level-1路由器无法与Level-2路由器建立邻接关系</p>
</li>
<li><p>Level-1路由器只负责维护Level-1的链路状态数据库LSDB，该LSDB只包含本区域的路由信息</p>
</li>
<li><p>Level-1路由器必须通过Level-1-2路由器接入IS-IS骨干区域从而访问其他区域。</p>
</li>
</ul>
<p><strong>Level-1-2路由器</strong></p>
<p>同时属于Level-1和Level-2的路由器称为Level-1-2路由器，它可以与同一区域的Level-1和Level-1-2路由器形成Level-1邻接关系，也可以与其他区域的Level-2和Level-1-2路由器形成Level-2的邻接关系</p>
<ul>
<li><font color="orange">Level-1-2路由器也是IS-IS骨干网络的组成部分</font></li>
<li>Level-1-2路由器维护两个LSDB，Level-1的LSDB用于区域内路由，Level-2的LSDB用于区域间路由</li>
</ul>
<p><strong>Level-2路由器</strong><br><font color="red">Level-2路由器，是IS-IS骨干路由器</font>，可以与同一或者不同区域的Level-2路由器或者Level-1-2路由器形成邻接关系</p>
<ul>
<li>Level-2路由器维护一个Level-2的LSDB，该LSDB包含整个IS-IS域的所有路由信息</li>
<li>所有形成Level-2邻接关系的路由器组成路由域的骨干网，负责在不同区域间通信</li>
<li>路由域中Level-2级别的路由器必须是物理连续的，以保证骨干网的连续性</li>
</ul>
<p><strong>IS-IS支持的网络类型：</strong><font color="orange">IS-IS会自动根据接口的数据链路层封装决定该接口的缺省网络类型</font> ， IS-IS支持两种类型的网络，广播Broadcast和点到点P2P网络如PPP、 HDLC等</p>
<h4 id="IS-IS开销值"><a href="#IS-IS开销值" class="headerlink" title="IS-IS开销值"></a>IS-IS开销值</h4><p>IS-IS使用Cost（开销）作为路由度量值，<font color="red">Cost值越小，则路径越优</font></p>
<ul>
<li>IS-IS链路的Cost与设备的接口有关，每一个激活了IS-IS的接口都会维护接口Cost</li>
<li><font color="blue">IS-IS接口的Cost在缺省情况下并不与接口带宽相关</font>，无论接口带宽多大，<font color="blue">缺省时Cost为10</font></li>
</ul>
<p><font color="FF6600">一条IS-IS路径的Cost等于本路由器到达目标网段沿途的<strong>所有链路的Cost总和</strong></font></p>
<ul>
<li>IS-IS有三种方式来确定接口的开销，按照优先级由高到低分别是：<ul>
<li>接口开销：为单个接口设置开销</li>
<li>全局开销：为所有接口设置开销</li>
<li>自动计算开销：根据接口带宽自动计算开销</li>
</ul>
</li>
</ul>
<blockquote>
<p>在早期的ISO10589中，使能IS-IS的接口下最大只能配置值为63的开销值，此时IS-IS的开销类型为narrow</p>
</blockquote>
<blockquote>
<p>RFC3784中规定，使能IS-IS的接口开销值可以扩展到16777215，此时IS-IS的开销类型为wide</p>
</blockquote>
<ul>
<li>缺省时，华为路由器采用的开销类型是narrow</li>
<li>narrow类型下使用的TLV：<ul>
<li>128号TLV（IP Internal Reachability TLV）：用来携带路由域内的IS-IS路由信息</li>
<li>130号TLV（IP External Reachability TLV）：用来携带路由域外的IS-IS路由信息</li>
<li>2号TLV(IS Neighbors TLV)：用来携带邻居信息。</li>
</ul>
</li>
<li>wide类型下使用的TLV：<ul>
<li>135号TLV(Extended IP Reachability TLV)：用来替换原有的IP reachability TLV，携带IS-IS路由信息，它扩展了路由开销值的范围，并可以携带sub TLV</li>
<li>22号TLV（IS Extended Neighbors TLV）：用来携带邻居信息</li>
</ul>
</li>
</ul>
<h3 id="IS-IS报文类型"><a href="#IS-IS报文类型" class="headerlink" title="IS-IS报文类型"></a>IS-IS报文类型</h3><p><font color="blue">IS-IS报文是直接封装在数据链路层的帧结构中的</font></p>
<ul>
<li>PDU，协议数据单元可以分为两个部分，报文头 IS-IS Header和变长字段部分 Variable Length Fields</li>
<li>IS-IS Header又可分为通用头部 PDU Common Header和专用头部 PDU Specific Header<ul>
<li>对于所有PDU来说，通用报头都是相同的，但专用报头根据PDU类型不同而有所差别</li>
</ul>
</li>
</ul>
<img src="https://shierjinghuang.github.io/2023/03/26/链路状态路由协议IS-IS/IS-IS报文类型.png" style="zoom:67%;" />

<h4 id="IS-IS通用字段详解："><a href="#IS-IS通用字段详解：" class="headerlink" title="IS-IS通用字段详解："></a>IS-IS通用字段详解：</h4><p><strong>重要字段解释：</strong></p>
<img src="https://shierjinghuang.github.io/2023/03/26/链路状态路由协议IS-IS/IS-IS通用首部.png" style="zoom: 80%;" />

<ul>
<li>Intradomain Routing Protocol Discriminator：域内路由选择协议鉴别符，固定为0x83</li>
<li>Length Indicator：IS-IS头部的长度（包括通用头部和专用头部），以Byte为单位</li>
<li>Version/Protocol ID Extension：版本/协议标识扩展，固定为0x01</li>
<li>System ID Length：NSAP地址或NET中System ID区域的长度。值为0时，表示System ID区域的长度为6Byte</li>
<li>R（Reserved）：保留，固定为0</li>
<li>Version：固定为0x01</li>
<li>Max.Areas：支持的最大区域个数。设置为1～254的整数，表示该IS-IS进程实际所允许的最大区域地址数；设置为0，表示该IS-IS进程最大只支持3个区域地址数</li>
</ul>
<h4 id="IS-IS报文类型概述"><a href="#IS-IS报文类型概述" class="headerlink" title="IS-IS报文类型概述"></a>IS-IS报文类型概述</h4><blockquote>
<p><font color="fasa">IS-IS的PDU有4种类型：IIH，LSP 链路状态报文，CSNP 全序列号报文，PSNP 部分序列号报文</font></p>
</blockquote>
<p><strong>IIH IS-IS Hello报文：用于建立和维持邻接关系</strong></p>
<ul>
<li>广播网络中的Level-1 IS-IS路由器使用Level-1 LAN IIH，广播网络中的Level-2 IS-IS路由器使用Level-2 LAN IIH</li>
<li>点到点网络中则使用P2P IIH</li>
</ul>
<p><strong>LSP 链路状态报文：用于交换链路状态信息</strong></p>
<ul>
<li>LSP分为两种，Level-1 LSP、Level-2 LSP</li>
</ul>
<p><strong>SNP 序列号报文：通过描述全部或部分链路数据库中的LSP来同步各LSDB，从而维护LSDB的完整与同步</strong></p>
<ul>
<li>SNP包括CSNP 全序列号报文和PSNP 部分序列号报文，进一步又可分为Level-1 CSNP、 Level-2 CSNP、 Level-1 PSNP和Level-2 PSNP。</li>
</ul>
<h4 id="IS-IS常见的TLV"><a href="#IS-IS常见的TLV" class="headerlink" title="IS-IS常见的TLV"></a>IS-IS常见的TLV</h4><p>IS-IS报文首部有一个TLV字段，TLV的含义是：类型（TYPE），长度（LENGTH），值（VALUE）。该字段实际上是一个数据结构，这个结构包含了这三部分</p>
<blockquote>
<p>使用TLV结构构建报文的好处是<font color="blue">灵活性和扩展性好</font>。采用TLV使得报文的整体结构固定，增加新特性只需要增加新TLV即可，不需要改变整个报文的整体结构。</p>
</blockquote>
<table>
<thead>
<tr>
<th>TLV Type</th>
<th>名称</th>
<th>PDU类型</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>Area Addresses                                                  区域地址</td>
<td>IIH、LSP</td>
</tr>
<tr>
<td>2</td>
<td>IS Neighbors（LSP）                                         中间系统邻接</td>
<td>LSP</td>
</tr>
<tr>
<td>4</td>
<td>Partition Designated Level2 IS                         区域分段指定L2中间系统</td>
<td>L2、LSP</td>
</tr>
<tr>
<td>6</td>
<td>IS Neighbors（MAC Address）                        中间系统邻接</td>
<td>LAN、IIH</td>
</tr>
<tr>
<td>7</td>
<td>IS Neighbors（SNPA Address）                       中间系统邻接</td>
<td>LAN、IIH</td>
</tr>
<tr>
<td>8</td>
<td>Padding                                                                填充</td>
<td>IIH</td>
</tr>
<tr>
<td>9</td>
<td>LSP Entries                                                           LSP条目</td>
<td>SNP</td>
</tr>
<tr>
<td>10</td>
<td>Authentication Information                              验证信息</td>
<td>IIH、LSP、SNP</td>
</tr>
<tr>
<td>128</td>
<td>IP Internal Reachability Information               IP内部可达性信息</td>
<td>LSP</td>
</tr>
<tr>
<td>129</td>
<td>Protocols Supported                                          支持的协议</td>
<td>IIH、LSP</td>
</tr>
<tr>
<td>130</td>
<td>IP External Reachability Information              IP外部可达性信息</td>
<td>LSP</td>
</tr>
<tr>
<td>131</td>
<td>Inter-Domain Routing Protocol Information 域间路由选择协议信息</td>
<td>L2、 LSP</td>
</tr>
<tr>
<td>132</td>
<td>IP Interface Address                                          IP接口地址</td>
<td>IIH 、LSP</td>
</tr>
</tbody></table>
<h2 id="IS-IS工作原理"><a href="#IS-IS工作原理" class="headerlink" title="IS-IS工作原理"></a>IS-IS工作原理</h2><h3 id="IS-IS邻接关系建立原则"><a href="#IS-IS邻接关系建立原则" class="headerlink" title="IS-IS邻接关系建立原则"></a>IS-IS邻接关系建立原则</h3><ul>
<li><p>IS-IS按如下原则建立邻接关系：</p>
<ul>
<li>只有同一层次的相邻路由器才有可能成为邻接</li>
<li>对于Level-1路由器来说，Area ID必须一致</li>
<li>链路两端IS-IS接口的网络类型必须一致</li>
<li>链路两端IS-IS接口的地址必须处于同一网段</li>
</ul>
</li>
<li><p>IS-IS是直接运行在数据链路层上的协议，并且最早设计是给CLNP使用的，IS-IS邻接关系的形成与IP地址无关</p>
</li>
<li><p>在实际的部署中，在IP网络上运行IS-IS时，需要检查对方的IP地址的。如果接口配置了从IP，那么只要双方有某个IP在同一网段，就能建立邻接，不一定要主IP相同。</p>
</li>
</ul>
<h5 id="在以太网中的额外原则："><a href="#在以太网中的额外原则：" class="headerlink" title="在以太网中的额外原则："></a>在以太网中的额外原则：</h5><ul>
<li>通过将以太网接口模拟成点到点接口，可以建立点到点链路邻接关系</li>
<li>当链路两端IS-IS接口的地址不在同一网段时，如果配置接口对接收的Hello报文不作IP地址检查，也可以建立邻接关系<ul>
<li>对于点到点接口，可以配置接口忽略IP地址检查</li>
<li>对于以太网接口，需要将以太网接口模拟成点到点接口，然后才可以配置接口忽略IP地址检查</li>
</ul>
</li>
<li>一般情况下，一个接口只需配置一个主IP地址，但在有些特殊情况下需要配置从IP地址</li>
</ul>
<h5 id="IIH报文"><a href="#IIH报文" class="headerlink" title="IIH报文"></a>IIH报文</h5><p>IIH报文用于建立和维持邻接关系，广播网络中的Level-1 IS-IS路由器使用Level-1 LAN IIH；广播网络中的Level-2 IS-IS路由器使用Level-2 LAN IIH；点到点网络中则使用P2P IIH</p>
<ul>
<li>Reserved/Circuit Type：表示路由器的类型 01表示L1，10表示L2，11表示L1/L2</li>
<li>Source ID  ：发出Hello报文的路由器的System ID</li>
<li>Holding Time ： 保持时间。在此时间内如果没有收到邻接发来的Hello报文，则中止已建立的邻接关系</li>
<li>Priority ：选举DIS的优先级，取值范围为0～127。数值越大，优先级越高。该字段只在广播网中的Hello消息(LAN IIH消息)携带；点到点网络的Hello消息(P2P IIH消息)没有此字段，也没有此字段之前的R保留位</li>
<li>LAN ID： 包括DIS的System ID和伪节点ID。该字段只在广播网中的Hello消息(LAN IIH消息)携带；点到点网络的Hello消息(P2P IIH消息)没有此字段</li>
<li>Local Circuit ID：本地链路ID，该字段只在点到点网络的Hello消息(P2P IIH消息)携带；广播网中的Hello消息(LAN IIH消息)没有此字段。 </li>
</ul>
<h4 id="广播网络中的邻接关系建立过程"><a href="#广播网络中的邻接关系建立过程" class="headerlink" title="广播网络中的邻接关系建立过程"></a>广播网络中的邻接关系建立过程</h4><p>两台运行IS-IS的路由器在交互协议报文实现路由功能之前必须首先建立邻接关系。在不同类型的网络上，IS-IS的邻接建立方式并不相同。在广播网络中，使用三次握手建立邻接关系</p>
<ol>
<li>在Down状态下，R1组播发送Level-1 LAN IIH，此报文中邻接列表为空</li>
<li>R2收到此报文后，将邻接状态标识为Initial。R2再向R1回复Level-1 LAN IIH，此报文中标识R1为R2的邻接</li>
<li>R1收到此报文后，将自己与R2的邻接状态标识为Up。再向R2发送一个标识R2为R1邻接的Level-1 LAN IIH</li>
<li>R2收到此报文后，将自己与R1的邻接状态标识为Up。这样，两个路由器成功建立了邻接关系</li>
<li>广播网络中需要选举DIS，在邻接关系建立后，路由器会等待两个Hello报文间隔，再进行DIS的选举。</li>
</ol>
<h5 id="DIS与伪节点"><a href="#DIS与伪节点" class="headerlink" title="DIS与伪节点"></a>DIS与伪节点</h5><p>在广播网络中，IS-IS需要在所有的路由器中选举一个路由器作为DIS (指定中间系统) </p>
<ul>
<li>DIS用来创建和更新伪节点（Pseudonodes），并负责生成伪节点的LSP，用来描述网络上有哪些网络设备</li>
<li>伪节点是用来模拟广播网络的一个虚拟节点，并非真实的路由器。在IS-IS中，伪节点用DIS的System ID和Circuit ID（非0值）标识</li>
</ul>
<img src="https://shierjinghuang.github.io/2023/03/26/链路状态路由协议IS-IS/IS-IS DIS与伪结点.png" style="zoom: 67%;" />

<h4 id="点到点网络中的邻接关系建立过程"><a href="#点到点网络中的邻接关系建立过程" class="headerlink" title="点到点网络中的邻接关系建立过程"></a>点到点网络中的邻接关系建立过程</h4><p>点到点网络中，邻接关系的建立使用两次握手方式：只要路由器收到对端发来的Hello报文，就单方面宣布邻接为Up状态，建立邻接关系<br>两次握手机制存在明显的缺陷，华为设备在点到点网络中使用IS-IS时，默认使用三次握手建立邻接关系。此方式通过三次发送P2P IIH最终建立起邻接关系</p>
<h3 id="链路状态数据库同步"><a href="#链路状态数据库同步" class="headerlink" title="链路状态数据库同步"></a>链路状态数据库同步</h3><h4 id="LSP"><a href="#LSP" class="headerlink" title="LSP"></a>LSP</h4><p>IS-IS链路状态报文LSP用于交换链路状态信息。LSP分为两种：Level–1 LSP和Level–2 LSP。Level–1 LSP由Level-1路由器传送，Level–2 LSP由Level-2路由器传送，Level-1-2路由器则可传送以上两种LSP</p>
<p>两类LSP有相同的报文格式</p>
<img src="https://shierjinghuang.github.io/2023/03/26/链路状态路由协议IS-IS/LSP报文格式.png" style="zoom:80%;" />

<ul>
<li><strong>Remaining Lifetime</strong> : LSP的生存时间，以秒为单位</li>
<li><strong>LSP ID</strong>:由三部分组成，System ID、伪节点ID和LSP分片后的编号</li>
<li><strong>Sequence Number</strong>: LSP的序列号。在路由器启动时所发送的第一个LSP报文中的序列号为1，以后当需要生成新的LSP时，新LSP的序列号在前一个LSP序列号的基础上加1。更高的序列号意味着更新的LSP</li>
<li>Checksum ： LSP的校验和</li>
<li><strong>ATT</strong>（Attachment）：由Level-1-2路由器产生，用来指明始发路由器是否与其它区域相连。虽然此标志位也存在于Level-1和Level-2的LSP中，但实际上此字段只和Level-1-2路由器始发的L1 LSP有关</li>
<li>OL（LSDB Overload，1bit）：过载标志位。设置了过载标志位的LSP虽然还会在网络中扩散，但是在计算通过超载路由器的路由时不会被采用。即对路由器设置过载位后，其它路由器在进行SPF计算时不会考虑这台路由器。当路由器内存不足时，系统自动在发送的LSP报文中设置过载标志位</li>
<li>IS Type(2bit)：生成LSP的路由器的类型。用来指明是Level-1还是Level-2路由器（01表示Level-1，11表示Level-2）</li>
</ul>
<h5 id="CSNP："><a href="#CSNP：" class="headerlink" title="CSNP："></a>CSNP：</h5><p>CSNP包含该设备LSDB中所有的LSP摘要，路由器通过交互 CSNP来判断是否需要同步LSDB</p>
<ul>
<li>在广播网络上，CSNP由DIS定期发送    缺省的发送周期为10秒</li>
<li>在点到点网络上，CSNP只在第一次建立邻接关系时发送</li>
</ul>
<p><strong>CSNP报文格式：</strong></p>
<img src="https://shierjinghuang.github.io/2023/03/26/链路状态路由协议IS-IS/CNSP报文格式.png" style="zoom:67%;" />

<ul>
<li>Source ID：发出CSNP报文的路由器的System ID</li>
<li>Start LSP：CSNP报文中第一个LSP的ID值</li>
<li>End LSP ID：CSNP报文中最后一个LSP的ID值</li>
</ul>
<h5 id="PSNP："><a href="#PSNP：" class="headerlink" title="PSNP："></a>PSNP：</h5><p>PSNP只包含部分LSP的摘要信息 ：</p>
<ul>
<li>当发现LSDB不同步时，PSNP来请求邻居发送新的LSP</li>
<li>在点到的网络中，当收到LSP时，使用PSNP对收到的LSP进行确认</li>
</ul>
<img src="https://shierjinghuang.github.io/2023/03/26/链路状态路由协议IS-IS/PSNP报文格式.png"  />

<ul>
<li>Source ID：发出PSNP报文的路由器的System ID。 </li>
</ul>
<h4 id="LSP的同步过程"><a href="#LSP的同步过程" class="headerlink" title="LSP的同步过程"></a>LSP的同步过程</h4><h5 id="广播网络中LSP的同步过程"><a href="#广播网络中LSP的同步过程" class="headerlink" title="广播网络中LSP的同步过程:"></a>广播网络中LSP的同步过程:</h5><ul>
<li><p>广播网络中新加入路由器与DIS同步LSDB数据库的过程：</p>
<ol>
<li><p>新加入的路由器R3首先发送IIH报文，与该广播域中的路由器建立邻接关系。建立邻接关系之后，R3等待LSP刷新定时器超时，然后将自己的LSP发往组播地址（Level-1：01-80-C2-00-00-14；Level-2：01-80-C2-00-00-15）。这样网络上所有的邻接都将收到该LSP</p>
</li>
<li><p>该网段中的DIS会把收到R3的LSP加入到LSDB中，并等待CSNP报文定时器超时并发送CSNP报文</p>
</li>
<li><p>R3收到DIS发来的CSNP报文，对比自己的LSDB数据库，然后向DIS发送PSNP报文请求自己没有的LSP</p>
</li>
<li><p>DIS收到该PSNP报文请求后向R3发送对应的LSP进行LSDB的同步</p>
<img src="https://shierjinghuang.github.io/2023/03/26/链路状态路由协议IS-IS/广播网络中LSP的同步过程.png" alt="广播网络中LSP的同步过程" style="zoom:80%;" /></li>
</ol>
</li>
</ul>
<h5 id="点到点网络中LSP的同步过程"><a href="#点到点网络中LSP的同步过程" class="headerlink" title="点到点网络中LSP的同步过程"></a>点到点网络中LSP的同步过程</h5><ul>
<li><p>点到点网络上LSDB数据库的同步过程：</p>
<ul>
<li><p>R1先与R2建立邻接关系。</p>
</li>
<li><p>建立邻接关系之后，R1与R2会先发送CSNP给对端设备。如果对端的LSDB与CSNP没有同步，则发送PSNP请求索取相应的LSP</p>
</li>
<li><p>假设R2向R1索取相应的LSP</p>
<ol>
<li><p>R1发送R2请求的LSP的同时启动LSP重传定时器，并等待R2发送的PSNP作为收到LSP的确认</p>
</li>
<li><p>如果在接口LSP重传定时器超时后，R1没有收到R2发送的PSNP报文作为应答</p>
</li>
<li><p>则R1重新发送该LSP</p>
</li>
<li><p>R2收到LSP后，发送PSNP进行确认</p>
<img src="https://shierjinghuang.github.io/2023/03/26/链路状态路由协议IS-IS/点到点网络中LSP同步过程.png" style="zoom:67%;" /></li>
</ol>
</li>
</ul>
</li>
</ul>
<p><strong>LSP产生的原因，IS-IS路由域内的所有路由器都会产生LSP，以下事件会触发一个新的LSP：</strong></p>
<blockquote>
<ul>
<li>邻接Up或Down，IS-IS相关接口Up或Down，引入的IP路由发生变化，区域间的IP路由发生变化，接口被赋了新的metric值，周期性更新（刷新间隔15min）</li>
</ul>
</blockquote>
<h4 id="LSP的处理机制"><a href="#LSP的处理机制" class="headerlink" title="LSP的处理机制"></a>LSP的处理机制</h4><img src="https://shierjinghuang.github.io/2023/03/26/链路状态路由协议IS-IS/LSP的处理机制.png" style="zoom: 80%;" />

<p>IS-IS通过交互LSP实现链路状态数据库同步，路由器收到LSP后，按照以下原则处理：</p>
<ul>
<li>若收到的LSP比本地LSP的更优，或者本地没有收到的LSP：<ul>
<li>在广播网络中：将其加入数据库，并组播发送新的LSP</li>
<li>在点到点网络中：将其加入数据库，并发送PSNP报文来确认收到此LSP，之后将这新的LSP发送给除了发送该LSP的邻居以外的邻居</li>
</ul>
</li>
<li>若收到的LSP和本地LSP无法比较出优劣，则不处理该LSP</li>
</ul>
<h3 id="路由计算"><a href="#路由计算" class="headerlink" title="路由计算"></a>路由计算</h3><h4 id="Level-1路由器的路由计算"><a href="#Level-1路由器的路由计算" class="headerlink" title="Level-1路由器的路由计算"></a>Level-1路由器的路由计算</h4><ul>
<li>R1是Level-1路由器，只维护Level-1 LSDB，该LSDB中包含同属一个区域的R2及R3以及R1自己产生的Level-1 LSP</li>
<li>R1根据LSDB中的Level-1 LSP计算出Area 49.0001内的拓扑，以及到达区域内各个网段的路由信息</li>
<li>R2及R3作为Area 49.0001内的Level-1-2路由器，会在它们向该区域下发的Level-1 LSP中设置ATT标志位，用于向区域内的Level-1路由器宣布可以通过自己到达其他区域。 R1作为Level-1路由器，会根据该ATT标志位，计算出指向R2或R3的默认路由</li>
</ul>
<img src="https://shierjinghuang.github.io/2023/03/26/链路状态路由协议IS-IS/Level-1路由器的路由计算.png" alt="Level-1路由器的路由计算" style="zoom:80%;" />

<h5 id="Level-1路由器的次优路径的问题"><a href="#Level-1路由器的次优路径的问题" class="headerlink" title="Level-1路由器的次优路径的问题"></a>Level-1路由器的次优路径的问题</h5><p>缺省时， R1只能通过指向R2或R3的默认路由到达区域外部，但是R1距离R2和R3路由器的Cost值相等，那么当R1发送数据包到192.168.20.0/24时，就有可能选择路径2，导致出现次优路径。</p>
<h5 id="路由渗透"><a href="#路由渗透" class="headerlink" title="路由渗透"></a>路由渗透</h5><p>缺省情况下，Level-1-2路由器不会将到达其他区域的路由通告本Level-1区域中。<br>通过路由渗透，可以将区域间路由通过Leve-1-2路由器传递到Level-1区域，此时Leve-1路由器可以学习到其他区域的详细路由，从而计算出最优路径。</p>
<h4 id="Level-1-2路由器的路由计算"><a href="#Level-1-2路由器的路由计算" class="headerlink" title="Level-1-2路由器的路由计算"></a>Level-1-2路由器的路由计算</h4><p>R2及R3都维护Level-1 LSDB，它们能够通过这些LSDB中的LSP计算出Area 49.0001的路由。<br>R2及R3都维护Level-2 LSDB，它们能够通过这些LSDB中的LSP计算出Area 49.0002的路由。<br>R2及R3将到达Area 49.0001的路由以Level-2 LSP的形式发送到Area 49.0002。</p>
<h4 id="Level-2路由器的路由计算"><a href="#Level-2路由器的路由计算" class="headerlink" title="Level-2路由器的路由计算"></a>Level-2路由器的路由计算</h4><p>R4及R5作为Level-2路由器，只会维护Level-2 LSDB，它们能够根据该LSDB计算出到达全网各个网段的路由。</p>
<h2 id="IS-IS的基本配置"><a href="#IS-IS的基本配置" class="headerlink" title="IS-IS的基本配置"></a>IS-IS的基本配置</h2><h3 id="IS-IS协议的基本配置"><a href="#IS-IS协议的基本配置" class="headerlink" title="IS-IS协议的基本配置"></a>IS-IS协议的基本配置</h3><p>1 . 创建IS-IS进程，进入IS-IS进程</p>
<pre class="line-numbers language-none"><code class="language-none">isis [process-id] <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>参数process-id用来指定一个IS-IS进程,如果不指定参数process-id，则系统默认的进程为1</p>
<p>2 . 配置网络实体名称</p>
<pre class="line-numbers language-none"><code class="language-none">network-entity net<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>通常情况下，一个IS-IS进程下配置一个NET即可。当区域需要重新划分时，例如将多个区域合并，或者将一个区域划分为多个区域，这种情况下配置多个NET可以在重新配置时仍然能够保证路由的正确性。由于一个IS-IS进程中区域地址最多可配置3个，所以NET最多也只能配3个。在配置多个NET时，必须保证它们的System ID都相同</p>
<p>3 . 配置全局Level级别</p>
<pre class="line-numbers language-none"><code class="language-none">is-level &#123; level-1 | level-1-2 | level-2 &#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>缺省情况下，设备的Level级别为level-1-2。</p>
<ul>
<li>在网络运行过程中，改变IS-IS设备的级别可能会导致IS-IS进程重启并可能会造成IS-IS邻居断连，建议用户在配置IS-IS时即完成设备级别的配置。 </li>
</ul>
<p>4 . 在接口上使能IS-IS协议</p>
<pre class="line-numbers language-none"><code class="language-none">isis enable [ process-id ]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>在接口视图下配置该命令后，IS-IS将通过该接口建立邻居、扩散LSP报文。</p>
<p>5 .  配置接口Level级别</p>
<pre class="line-numbers language-none"><code class="language-none">isis circuit-level [ level-1 | level-1-2 | level-2 ]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>缺省情况下，接口的Level级别为level-1-2。<br>两台Level-1-2设备建立邻居关系时，缺省情况下，会分别建立Level-1和Level-2邻居关系。如果只希望建立Level-1或者Level-2的邻居关系，可以通过修改接口的Level级别实现。</p>
<p>6 .  修改接口的DIS优先级</p>
<pre class="line-numbers language-none"><code class="language-none">isis dis-priority priority [level-1 | level-2]<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>缺省情况下，IS-IS接口DIS优先级为64，该命令用来指定挑选对应层次DIS（Designated Intermediate System）时接口的优先级</p>
<h3 id="IS-IS配置实验："><a href="#IS-IS配置实验：" class="headerlink" title="IS-IS配置实验："></a>IS-IS配置实验：</h3><img src="https://shierjinghuang.github.io/2023/03/26/链路状态路由协议IS-IS/IS-IS配置实验拓扑.png" />

<h4 id="配置接口IP"><a href="#配置接口IP" class="headerlink" title="配置接口IP"></a>配置接口IP</h4><h4 id="配置IS-IS基本功能"><a href="#配置IS-IS基本功能" class="headerlink" title="配置IS-IS基本功能"></a>配置IS-IS基本功能</h4><h5 id="配置R1"><a href="#配置R1" class="headerlink" title="# 配置R1"></a># 配置R1</h5><pre class="line-numbers language-华为" data-language="华为"><code class="language-华为">[R1] isis 1
[R1-isis-1] is-level level-1
[R1-isis-1] network-entity 10.0000.0000.0001.00
[R1-isis-1] quit
[R1] interface gigabitethernet 0&#x2F;0&#x2F;0
[R1-GigabitEthernet0&#x2F;0&#x2F;0] isis enable 1
[R1-GigabitEthernet0&#x2F;0&#x2F;0] quit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="配置R3"><a href="#配置R3" class="headerlink" title="# 配置R3"></a># 配置R3</h5><pre class="line-numbers language-华为" data-language="华为"><code class="language-华为">[R3] isis 1
[R3-isis-1] is-level level-1
[R3-isis-1] network-entity 10.0000.0000.0003.00
[R3-isis-1] quit
[R3] interface gigabitethernet 0&#x2F;0&#x2F;0
[R3-GigabitEthernet0&#x2F;0&#x2F;0] isis enable 1
[R3-GigabitEthernet0&#x2F;0&#x2F;0] quit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="配置R2"><a href="#配置R2" class="headerlink" title="# 配置R2"></a># 配置R2</h5><pre class="line-numbers language-华为" data-language="华为"><code class="language-华为">[R2] isis 1
[R2-isis-1] network-entity 10.0000.0000.0002.00
[R2-isis-1] quit
[R2] interface gigabitethernet 0&#x2F;0&#x2F;0
[R2-GigabitEthernet0&#x2F;0&#x2F;0] isis enable 1
[R2-GigabitEthernet0&#x2F;0&#x2F;0] quit
[R2] interface gigabitethernet 0&#x2F;0&#x2F;1
[R2-GigabitEthernet0&#x2F;0&#x2F;1] isis enable 1
[R2-GigabitEthernet0&#x2F;0&#x2F;2] quit
[R2] interface gigabitethernet 3&#x2F;0&#x2F;0
[R2-GigabitEthernet0&#x2F;0&#x2F;2] isis enable 1
[R2-GigabitEthernet0&#x2F;0&#x2F;2] quit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="配置R4"><a href="#配置R4" class="headerlink" title="# 配置R4"></a># 配置R4</h5><pre class="line-numbers language-华为" data-language="华为"><code class="language-华为">[R4] isis 1
[R4-isis-1] is-level level-2
[R4-isis-1] network-entity 20.0000.0000.0004.00
[R4-isis-1] quit
[R4] interface gigabitethernet0&#x2F;0&#x2F;0
[R4-GigabitEthernet0&#x2F;0&#x2F;0] isis enable 1
[R4-GigabitEthernet0&#x2F;0&#x2F;0] quit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">十二惊惶</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://shierjinghuang.github.io/2023/03/26/%E9%93%BE%E8%B7%AF%E7%8A%B6%E6%80%81%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AEIS-IS/">https://shierjinghuang.github.io/2023/03/26/%E9%93%BE%E8%B7%AF%E7%8A%B6%E6%80%81%E8%B7%AF%E7%94%B1%E5%8D%8F%E8%AE%AEIS-IS/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">十二惊惶</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/HCIP/">
                                    <span class="chip bg-color">HCIP</span>
                                </a>
                            
                                <a href="/tags/IS-IS/">
                                    <span class="chip bg-color">IS-IS</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2023/03/30/README_CN/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/1.jpg" class="responsive-img" alt="hexo-theme-matery">
                        
                        <span class="card-title">hexo-theme-matery</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2023-03-30
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E4%B8%AA%E4%BA%BA/" class="post-category">
                                    个人
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Hexo/">
                        <span class="chip bg-color">Hexo</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2023/03/18/Java%E5%AE%9E%E8%AE%AD/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/13.jpg" class="responsive-img" alt="Java项目 即时通讯系统">
                        
                        <span class="card-title">Java项目 即时通讯系统</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            这是你自定义的文章摘要内容，如果这个属性有值，文章卡片摘要就显示这段文字，否则程序会自动截取文章的部分内容作为摘要
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-03-18
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E4%B8%AA%E4%BA%BA/" class="post-category">
                                    个人
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/Java/">
                        <span class="chip bg-color">Java</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>


  <!-- 是否加载使用自带的 prismjs. -->
  <script type="text/javascript" src="/libs/prism/prism.min.js"></script>


<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>



    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2023</span>
            
            <a href="/about" target="_blank">十二惊惶</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
                &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                        class="white-color">367.9k</span>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/blinkfox" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:572688347@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=572688347" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 572688347" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 白天和黑夜主题 -->
<div class="stars-con">
    <div id="stars"></div>
    <div id="stars2"></div>
    <div id="stars3"></div>  
</div>

<script>
    function switchNightMode() {
        $('<div class="Cuteen_DarkSky"><div class="Cuteen_DarkPlanet"></div></div>').appendTo($('body')),
        setTimeout(function () {
            $('body').hasClass('DarkMode') 
            ? ($('body').removeClass('DarkMode'), localStorage.setItem('isDark', '0'), $('#sum-moon-icon').removeClass("fa-sun").addClass('fa-moon')) 
            : ($('body').addClass('DarkMode'), localStorage.setItem('isDark', '1'), $('#sum-moon-icon').addClass("fa-sun").removeClass('fa-moon')),
            
            setTimeout(function () {
            $('.Cuteen_DarkSky').fadeOut(1e3, function () {
                $(this).remove()
            })
            }, 2e3)
        })
    }
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
